<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LLM Iterative Debate</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/tailwindcss/2.2.19/tailwind.min.css" rel="stylesheet">
    <style>
        body { 
            font-family: system-ui, sans-serif; 
        }
        .gradient-bg { 
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); 
        }
        .thinking { 
            animation: pulse 2s infinite; 
        }
        @keyframes pulse { 
            0%, 100% { opacity: 1; } 
            50% { opacity: 0.5; } 
        }
        .debate-flow {
            position: relative;
        }
        .debate-flow::before {
            content: '';
            position: absolute;
            left: 20px;
            top: 0;
            bottom: 0;
            width: 2px;
            background: linear-gradient(to bottom, #3b82f6, #8b5cf6, #10b981);
        }
    </style>
</head>
<body class="bg-gray-50 min-h-screen">

    <div class="gradient-bg text-white p-6 shadow-lg">
        <div class="max-w-6xl mx-auto">
            <h1 class="text-3xl font-bold mb-2">
                <span onclick="goHome()" class="cursor-pointer hover:text-blue-200 transition-colors" title="Return to Home">🤖</span> 
                AI Iterative Debate
            </h1>
            <p class="text-blue-100">GPT-4, Claude & Gemini debate until they reach consensus</p>
        </div>
    </div>

    <div class="max-w-6xl mx-auto p-6">
        
        <!-- API Keys Setup -->
        <div id="apiSetup" class="bg-white rounded-lg shadow-lg p-6 mb-6">
            <h2 class="text-2xl font-bold mb-4">🔑 Step 1: Add Your API Keys</h2>
            <div class="grid md:grid-cols-3 gap-4 mb-4">
                <div>
                    <label class="block text-sm font-medium mb-2">OpenAI API Key</label>
                    <input type="password" id="openaiKey" placeholder="sk-..." class="w-full p-3 border rounded-lg focus:ring-2 focus:ring-blue-500">
                    <small class="text-gray-500">Get from: platform.openai.com</small>
                </div>
                <div>
                    <label class="block text-sm font-medium mb-2">Anthropic API Key</label>
                    <input type="password" id="anthropicKey" placeholder="sk-ant..." class="w-full p-3 border rounded-lg focus:ring-2 focus:ring-blue-500">
                    <small class="text-gray-500">Get from: console.anthropic.com</small>
                </div>
                <div>
                    <label class="block text-sm font-medium mb-2">Google AI API Key</label>
                    <input type="password" id="geminiKey" placeholder="AIza..." class="w-full p-3 border rounded-lg focus:ring-2 focus:ring-blue-500">
                    <small class="text-gray-500">Get from: ai.google.dev</small>
                </div>
            </div>
            <button onclick="saveKeys()" class="bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 mr-4">
                Save Keys & Continue
            </button>
            <button onclick="useDemoMode()" class="bg-yellow-600 text-white px-6 py-2 rounded-lg hover:bg-yellow-700">
                Use Demo Mode
            </button>
            <div class="mt-4 p-4 bg-green-50 border-l-4 border-green-400">
                <p class="text-sm"><strong>New Design:</strong> AIs debate each other directly, responding to previous arguments until they reach natural consensus!</p>
            </div>
        </div>

        <!-- Main App -->
        <div id="mainApp" style="display: none;">
            
            <!-- Topic Setup -->
            <div id="topicSetup" class="bg-white rounded-lg shadow-lg p-6 mb-6">
                <h2 class="text-2xl font-bold mb-4">💭 Step 2: Choose Your Debate Topic</h2>
                <input type="text" id="topicInput" placeholder="Enter a debate topic..." class="w-full p-3 border rounded-lg mb-4">
                
                <div class="mb-4">
                    <h3 class="font-medium mb-2">Suggested Topics:</h3>
                    <div class="space-y-2">
                        <button onclick="setTopic('Should AI systems be granted legal personhood?')" class="w-full text-left p-3 bg-gray-50 hover:bg-gray-100 rounded">
                            Should AI systems be granted legal personhood?
                        </button>
                        <button onclick="setTopic('Is remote work better for society than office work?')" class="w-full text-left p-3 bg-gray-50 hover:bg-gray-100 rounded">
                            Is remote work better for society than office work?
                        </button>
                        <button onclick="setTopic('Should social media be regulated as a public utility?')" class="w-full text-left p-3 bg-gray-50 hover:bg-gray-100 rounded">
                            Should social media be regulated as a public utility?
                        </button>
                        <button onclick="setTopic('Will AI make universal basic income necessary?')" class="w-full text-left p-3 bg-gray-50 hover:bg-gray-100 rounded">
                            Will AI make universal basic income necessary?
                        </button>
                    </div>
                </div>
                
                <button onclick="startDebate()" class="bg-green-600 text-white px-6 py-3 rounded-lg hover:bg-green-700">
                    🚀 Start AI Debate
                </button>
            </div>

            <!-- Debate Arena -->
            <div id="debateArena" style="display: none;">
                
                <!-- Current Topic -->
                <div class="bg-blue-50 border-l-4 border-blue-500 p-4 rounded mb-6">
                    <h3 class="font-bold text-blue-900">Debate Topic:</h3>
                    <p id="currentTopic" class="text-blue-800"></p>
                </div>

                <!-- Debate Status -->
                <div class="grid md:grid-cols-4 gap-4 mb-6">
                    <div class="bg-white p-4 rounded-lg shadow border-l-4 border-blue-500">
                        <div class="flex items-center mb-2">
                            <div class="w-3 h-3 bg-blue-500 rounded-full mr-2"></div>
                            <span class="font-medium">GPT-4</span>
                        </div>
                        <div id="status1" class="text-xs text-gray-400">Ready</div>
                    </div>
                    <div class="bg-white p-4 rounded-lg shadow border-l-4 border-purple-500">
                        <div class="flex items-center mb-2">
                            <div class="w-3 h-3 bg-purple-500 rounded-full mr-2"></div>
                            <span class="font-medium">Claude</span>
                        </div>
                        <div id="status2" class="text-xs text-gray-400">Ready</div>
                    </div>
                    <div class="bg-white p-4 rounded-lg shadow border-l-4 border-green-500">
                        <div class="flex items-center mb-2">
                            <div class="w-3 h-3 bg-green-500 rounded-full mr-2"></div>
                            <span class="font-medium">Gemini</span>
                        </div>
                        <div id="status3" class="text-xs text-gray-400">Ready</div>
                    </div>
                    <div class="bg-white p-4 rounded-lg shadow">
                        <div class="text-sm font-medium mb-1">Round</div>
                        <div id="roundCounter" class="text-2xl font-bold text-gray-600">1</div>
                        <div class="text-xs text-gray-400">of 10 max</div>
                    </div>
                </div>

                <!-- Debate Flow -->
                <div id="debateFlow" class="debate-flow space-y-6 mb-6"></div>

                <!-- Controls -->
                <div class="bg-white p-4 rounded-lg shadow text-center">
                    <button id="continueBtn" onclick="continueDebate()" style="display: none;" class="bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 mr-4">
                        Continue Debate
                    </button>
                    <button id="finishBtn" onclick="forceFinish()" style="display: none;" class="bg-red-600 text-white px-6 py-2 rounded-lg hover:bg-red-700">
                        Force Finish
                    </button>
                </div>
            </div>

            <!-- Final Consensus -->
            <div id="finalResult" style="display: none;">
                <div class="bg-white rounded-lg shadow-lg p-6">
                    <h2 class="text-2xl font-bold mb-4">🎯 Final Consensus Reached</h2>
                    <div id="consensusContainer"></div>
                    <button onclick="resetDebate()" class="mt-6 bg-gray-600 text-white px-6 py-3 rounded-lg hover:bg-gray-700">
                        Start New Debate
                    </button>
                </div>
            </div>
        </div>
    </div>

<script>
// Global variables
var apiKeys = {};
var currentRound = 1;
var maxRounds = 10;
var debateHistory = [];
var isDemoMode = false;
var isDebating = false;

// Demo responses that build on each other
var demoConversation = [
    {
        gpt4: "I believe this topic has significant merit based on current evidence and trends. The data suggests clear benefits in terms of efficiency, innovation, and addressing contemporary challenges that traditional approaches haven't solved effectively.",
        claude: "While I understand the appeal of this position, I have concerns about potential unintended consequences. We should carefully consider the ethical implications and ensure that any changes don't inadvertently harm vulnerable populations or undermine important values.",
        gemini: "Both perspectives raise valid points. The evidence does show potential benefits, but the concerns about implementation are legitimate. Perhaps we need a more nuanced approach that captures the advantages while mitigating the risks through careful design and oversight."
    },
    {
        gpt4: "I appreciate Claude's ethical concerns, but I think they can be addressed through proper safeguards and gradual implementation. The research shows that pilot programs have been successful when properly managed, and the cost of inaction may be greater than the risks of action.",
        claude: "Gemini makes a good point about nuanced approaches. I'm not opposed to change, but I believe we need stronger accountability mechanisms and clearer protections for those who might be negatively affected. The pilot programs GPT-4 mentions did show some success, but they also revealed implementation challenges we shouldn't ignore.",
        gemini: "I'm seeing more convergence in our positions. We all seem to agree that some form of action is needed, but with proper safeguards. The question becomes: what specific protections and oversight mechanisms would make this acceptable to all stakeholders?"
    },
    {
        gpt4: "You're right, Gemini - we are converging. Based on our discussion, I think we could support a carefully phased approach with robust monitoring, clear success metrics, and built-in mechanisms for course correction. This addresses Claude's concerns while still moving forward with the beneficial aspects.",
        claude: "I find myself agreeing with this framework. A phased approach with strong ethical oversight, meaningful stakeholder input, and the ability to pause or adjust based on real-world outcomes could work. The key is ensuring accountability and transparency throughout the process.",
        gemini: "This feels like a solid consensus. We're proposing a measured implementation with: phased rollout, continuous monitoring, ethical oversight, stakeholder engagement, and adaptive mechanisms. This balances the potential benefits with responsible risk management."
    }
];

// API call functions
async function callOpenAI(prompt, context) {
    if (!apiKeys.openai) {
        throw new Error('OpenAI API key not provided');
    }
    
    try {
        var messages = [
            {
                role: "system", 
                content: currentRound === 1 ? 
                    "You are participating in a respectful debate with other AI systems. Give your initial thoughtful perspective on this topic in 2-3 sentences." :
                    "You are participating in a respectful debate. Read the previous round carefully and respond to the other AIs' points. You can agree, disagree, or build on their ideas. Keep responses to 2-3 sentences."
            }
        ];
        
        if (context && currentRound > 1) {
            messages.push({role: "user", content: "Previous debate round:\n" + context + "\n\nNow respond to their points:"});
        }
        
        messages.push({role: "user", content: prompt});
        
        var response = await fetch('https://api.openai.com/v1/chat/completions', {
            method: 'POST',
            headers: {
                'Authorization': 'Bearer ' + apiKeys.openai,
                'Content-Type': 'application/json'
            },
            body: JSON.stringify({
                model: "gpt-4",
                messages: messages,
                max_tokens: 150,
                temperature: 0.7
            })
        });
        
        if (!response.ok) {
            throw new Error('OpenAI API error: ' + response.status);
        }
        
        var data = await response.json();
        return data.choices[0].message.content;
    } catch (error) {
        console.error('OpenAI API call failed:', error);
        throw error;
    }
}

async function callAnthropic(prompt, context) {
    if (!apiKeys.anthropic) {
        throw new Error('Anthropic API key not provided');
    }
    
    try {
        var fullPrompt = currentRound === 1 ?
            "Give your thoughtful perspective on this topic in 2-3 sentences: " + prompt :
            "Previous debate round:\n" + context + "\n\nTopic: " + prompt + "\n\nPlease respond to the other AIs' points from the previous round. You can agree, disagree, or build on their ideas. Keep your response to 2-3 sentences.";
        
        var response = await fetch('https://api.anthropic.com/v1/messages', {
            method: 'POST',
            headers: {
                'x-api-key': apiKeys.anthropic,
                'Content-Type': 'application/json',
                'anthropic-version': '2023-06-01'
            },
            body: JSON.stringify({
                model: "claude-3-sonnet-20240229",
                max_tokens: 150,
                messages: [
                    {
                        role: "user",
                        content: fullPrompt
                    }
                ]
            })
        });
        
        if (!response.ok) {
            throw new Error('Anthropic API error: ' + response.status);
        }
        
        var data = await response.json();
        return data.content[0].text;
    } catch (error) {
        console.error('Anthropic API call failed:', error);
        throw error;
    }
}

async function callGemini(prompt, context) {
    if (!apiKeys.gemini) {
        throw new Error('Gemini API key not provided');
    }
    
    try {
        var fullPrompt = currentRound === 1 ?
            "Give your thoughtful perspective on this topic in 2-3 sentences: " + prompt :
            "Previous debate round:\n" + context + "\n\nTopic: " + prompt + "\n\nPlease respond to the other AIs' points from the previous round. You can agree, disagree, or build on their ideas. Help find common ground where possible. Keep your response to 2-3 sentences.";
        
        var response = await fetch('https://generativelanguage.googleapis.com/v1beta/models/gemini-pro:generateContent?key=' + apiKeys.gemini, {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify({
                contents: [{
                    parts: [{
                        text: fullPrompt
                    }]
                }],
                generationConfig: {
                    temperature: 0.7,
                    maxOutputTokens: 150
                }
            })
        });
        
        if (!response.ok) {
            throw new Error('Gemini API error: ' + response.status);
        }
        
        var data = await response.json();
        return data.candidates[0].content.parts[0].text;
    } catch (error) {
        console.error('Gemini API call failed:', error);
        throw error;
    }
}

function saveKeys() {
    apiKeys.openai = document.getElementById('openaiKey').value;
    apiKeys.anthropic = document.getElementById('anthropicKey').value;
    apiKeys.gemini = document.getElementById('geminiKey').value;
    
    if (!apiKeys.openai && !apiKeys.anthropic && !apiKeys.gemini) {
        alert('Please enter at least one API key, or use demo mode.');
        return;
    }
    
    document.getElementById('apiSetup').style.display = 'none';
    document.getElementById('mainApp').style.display = 'block';
}

function useDemoMode() {
    isDemoMode = true;
    document.getElementById('apiSetup').style.display = 'none';
    document.getElementById('mainApp').style.display = 'block';
}

function setTopic(topic) {
    document.getElementById('topicInput').value = topic;
}

function startDebate() {
    var topic = document.getElementById('topicInput').value;
    if (!topic.trim()) {
        alert('Please enter a debate topic.');
        return;
    }

    document.getElementById('currentTopic').textContent = topic;
    document.getElementById('topicSetup').style.display = 'none';
    document.getElementById('debateArena').style.display = 'block';
    
    // Reset variables
    currentRound = 1;
    debateHistory = [];
    isDebating = true;
    
    // Start first round
    generateRound();
}

async function generateRound() {
    if (!isDebating || currentRound > maxRounds) {
        return;
    }
    
    // Update round counter
    document.getElementById('roundCounter').textContent = currentRound;
    
    // Show thinking status
    document.getElementById('status1').textContent = 'Thinking...';
    document.getElementById('status2').textContent = 'Thinking...';
    document.getElementById('status3').textContent = 'Thinking...';
    
    var topic = document.getElementById('currentTopic').textContent;
    var context = buildContext();
    
    var responses = {};
    
    try {
        if (isDemoMode) {
            // Simulate thinking delay
            await new Promise(function(resolve) {
                setTimeout(resolve, 2000);
            });
            
            var demoIndex = Math.min(currentRound - 1, demoConversation.length - 1);
            responses = {
                gpt4: demoConversation[demoIndex].gpt4,
                claude: demoConversation[demoIndex].claude,
                gemini: demoConversation[demoIndex].gemini
            };
        } else {
            // Make API calls - simultaneous for Round 1, then responding to previous rounds
            var promises = [];
            
            if (apiKeys.openai) {
                promises.push(
                    callOpenAI(topic, context).then(function(result) {
                        responses.gpt4 = result;
                        document.getElementById('status1').textContent = 'Complete';
                    }).catch(function(error) {
                        console.error('GPT-4 failed:', error);
                        var demoIndex = Math.min(currentRound - 1, demoConversation.length - 1);
                        responses.gpt4 = demoConversation[demoIndex].gpt4;
                        document.getElementById('status1').textContent = 'Fallback';
                    })
                );
            } else {
                var demoIndex = Math.min(currentRound - 1, demoConversation.length - 1);
                responses.gpt4 = demoConversation[demoIndex].gpt4;
                document.getElementById('status1').textContent = 'Demo Mode';
            }
            
            if (apiKeys.anthropic) {
                promises.push(
                    callAnthropic(topic, context).then(function(result) {
                        responses.claude = result;
                        document.getElementById('status2').textContent = 'Complete';
                    }).catch(function(error) {
                        console.error('Claude failed:', error);
                        var demoIndex = Math.min(currentRound - 1, demoConversation.length - 1);
                        responses.claude = demoConversation[demoIndex].claude;
                        document.getElementById('status2').textContent = 'Fallback';
                    })
                );
            } else {
                var demoIndex = Math.min(currentRound - 1, demoConversation.length - 1);
                responses.claude = demoConversation[demoIndex].claude;
                document.getElementById('status2').textContent = 'Demo Mode';
            }
            
            if (apiKeys.gemini) {
                promises.push(
                    callGemini(topic, context).then(function(result) {
                        responses.gemini = result;
                        document.getElementById('status3').textContent = 'Complete';
                    }).catch(function(error) {
                        console.error('Gemini failed:', error);
                        var demoIndex = Math.min(currentRound - 1, demoConversation.length - 1);
                        responses.gemini = demoConversation[demoIndex].gemini;
                        document.getElementById('status3').textContent = 'Fallback';
                    })
                );
            } else {
                var demoIndex = Math.min(currentRound - 1, demoConversation.length - 1);
                responses.gemini = demoConversation[demoIndex].gemini;
                document.getElementById('status3').textContent = 'Demo Mode';
            }
            
            // Wait for all API calls to complete
            if (promises.length > 0) {
                await Promise.all(promises);
            }
        }
        
        // Add to debate history
        debateHistory.push({
            round: currentRound,
            responses: responses
        });
        
        // Display the round
        displayRound(responses);
        
        // Update status for demo mode
        if (isDemoMode) {
            document.getElementById('status1').textContent = 'Demo Complete';
            document.getElementById('status2').textContent = 'Demo Complete';
            document.getElementById('status3').textContent = 'Demo Complete';
        }
        
        // Check for consensus or continue
        if (checkForConsensus(responses) || currentRound >= maxRounds) {
            finishDebate();
        } else {
            currentRound++;
            document.getElementById('continueBtn').style.display = 'inline-block';
            document.getElementById('finishBtn').style.display = 'inline-block';
        }
        
    } catch (error) {
        console.error('Error generating responses:', error);
        alert('Error generating responses. Using demo mode for this round.');
        
        var demoIndex = Math.min(currentRound - 1, demoConversation.length - 1);
        responses = {
            gpt4: demoConversation[demoIndex].gpt4,
            claude: demoConversation[demoIndex].claude,
            gemini: demoConversation[demoIndex].gemini
        };
        
        debateHistory.push({
            round: currentRound,
            responses: responses
        });
        
        displayRound(responses);
    }
}

function buildContext() {
    if (debateHistory.length === 0) return "";
    
    // Only use the most recent round for context (not all rounds)
    var lastRound = debateHistory[debateHistory.length - 1];
    var context = "Previous Round " + lastRound.round + ":\n";
    context += "GPT-4: " + lastRound.responses.gpt4 + "\n";
    context += "Claude: " + lastRound.responses.claude + "\n";
    context += "Gemini: " + lastRound.responses.gemini;
    return context;
}

function displayRound(responses) {
    var container = document.getElementById('debateFlow');
    var roundDiv = document.createElement('div');
    roundDiv.className = 'ml-12 relative';
    
    var html = '<div class="absolute -left-14 top-2 w-8 h-8 bg-gray-200 rounded-full flex items-center justify-center text-sm font-bold">' + currentRound + '</div>';
    html += '<div class="space-y-4">';
    
    // GPT-4
    html += '<div class="bg-blue-50 border border-blue-200 rounded-lg p-4">';
    html += '<div class="flex items-center mb-2">';
    html += '<div class="w-3 h-3 bg-blue-500 rounded-full mr-2"></div>';
    html += '<span class="font-medium text-blue-900">GPT-4</span>';
    html += '</div>';
    html += '<p class="text-gray-700">' + responses.gpt4 + '</p>';
    html += '</div>';
    
    // Claude
    html += '<div class="bg-purple-50 border border-purple-200 rounded-lg p-4">';
    html += '<div class="flex items-center mb-2">';
    html += '<div class="w-3 h-3 bg-purple-500 rounded-full mr-2"></div>';
    html += '<span class="font-medium text-purple-900">Claude</span>';
    html += '</div>';
    html += '<p class="text-gray-700">' + responses.claude + '</p>';
    html += '</div>';
    
    // Gemini
    html += '<div class="bg-green-50 border border-green-200 rounded-lg p-4">';
    html += '<div class="flex items-center mb-2">';
    html += '<div class="w-3 h-3 bg-green-500 rounded-full mr-2"></div>';
    html += '<span class="font-medium text-green-900">Gemini</span>';
    html += '</div>';
    html += '<p class="text-gray-700">' + responses.gemini + '</p>';
    html += '</div>';
    
    html += '</div>';
    roundDiv.innerHTML = html;
    
    container.appendChild(roundDiv);
    
    // Scroll to bottom
    roundDiv.scrollIntoView({ behavior: 'smooth' });
}

function checkForConsensus(responses) {
    // Simple consensus detection - look for agreement keywords
    var text = (responses.gpt4 + " " + responses.claude + " " + responses.gemini).toLowerCase();
    var agreementWords = ['agree', 'consensus', 'converge', 'common ground', 'together', 'unified', 'aligned'];
    
    var agreementCount = 0;
    for (var i = 0; i < agreementWords.length; i++) {
        if (text.includes(agreementWords[i])) {
            agreementCount++;
        }
    }
    
    return agreementCount >= 2; // If multiple agreement indicators found
}

function continueDebate() {
    document.getElementById('continueBtn').style.display = 'none';
    document.getElementById('finishBtn').style.display = 'none';
    generateRound();
}

function forceFinish() {
    finishDebate();
}

function finishDebate() {
    isDebating = false;
    document.getElementById('debateArena').style.display = 'none';
    document.getElementById('finalResult').style.display = 'block';
    
    // Generate consensus summary
    var container = document.getElementById('consensusContainer');
    var html = '<div class="mb-6">';
    html += '<h3 class="text-lg font-bold mb-4">🤝 Debate Conclusion after ' + debateHistory.length + ' rounds</h3>';
    
    if (debateHistory.length > 0) {
        var lastRound = debateHistory[debateHistory.length - 1];
        html += '<div class="space-y-4">';
        html += '<div class="border-l-4 border-blue-500 pl-4 bg-blue-50 p-3 rounded">';
        html += '<strong>GPT-4 Final Position:</strong><br>' + lastRound.responses.gpt4;
        html += '</div>';
        html += '<div class="border-l-4 border-purple-500 pl-4 bg-purple-50 p-3 rounded">';
        html += '<strong>Claude Final Position:</strong><br>' + lastRound.responses.claude;
        html += '</div>';
        html += '<div class="border-l-4 border-green-500 pl-4 bg-green-50 p-3 rounded">';
        html += '<strong>Gemini Final Position:</strong><br>' + lastRound.responses.gemini;
        html += '</div>';
        html += '</div>';
        
        html += '<div class="mt-6 p-4 bg-yellow-50 border-l-4 border-yellow-400 rounded">';
        html += '<h4 class="font-bold mb-2">📋 Debate Summary</h4>';
        html += '<p class="text-sm">The three AI systems engaged in ' + debateHistory.length + ' rounds of iterative debate, ';
        
        if (checkForConsensus(lastRound.responses)) {
            html += 'reaching a natural consensus on the topic.</p>';
        } else {
            html += 'exploring different perspectives and finding areas of agreement.</p>';
        }
        html += '</div>';
    }
    
    html += '</div>';
    container.innerHTML = html;
}

function resetDebate() {
    // Reset all displays
    document.getElementById('finalResult').style.display = 'none';
    document.getElementById('debateArena').style.display = 'none';
    document.getElementById('topicSetup').style.display = 'block';
    
    // Clear inputs and containers
    document.getElementById('topicInput').value = '';
    document.getElementById('debateFlow').innerHTML = '';
    document.getElementById('consensusContainer').innerHTML = '';
    
    // Reset buttons
    document.getElementById('continueBtn').style.display = 'none';
    document.getElementById('finishBtn').style.display = 'none';
    
    // Reset variables
    currentRound = 1;
    debateHistory = [];
    isDebating = false;
    
    // Reset status displays
    document.getElementById('status1').textContent = 'Ready';
    document.getElementById('status2').textContent = 'Ready';
    document.getElementById('status3').textContent = 'Ready';
    document.getElementById('roundCounter').textContent = '1';
}

function goHome() {
    // Stop any ongoing debate
    isDebating = false;
    
    // Show API setup if no keys are saved, otherwise show topic setup
    if (!isDemoMode && !apiKeys.openai && !apiKeys.anthropic && !apiKeys.gemini) {
        document.getElementById('apiSetup').style.display = 'block';
        document.getElementById('mainApp').style.display = 'none';
    } else {
        // Reset to topic selection
        resetDebate();
    }
}
</script>

</body>
</html>
